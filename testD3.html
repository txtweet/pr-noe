<svg></svg>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="https://d3js.org/d3-hierarchy.v2.min.js"></script>

<script>
  const myRequest = new Request('flare-2.json');

  fetch(myRequest)
    .then(response => response.json())
    .then(data => {
      var family = d3.hierarchy(data)

      const width = 954;

      const tree = data => {
        const root = data;
        root.dx = 60;
        root.dy = width / (root.height + 1);
        return d3.tree().nodeSize([root.dx, root.dy])(root);
      }
      const treeLayout = tree(family);

      let x0 = Infinity;
      let x1 = -x0;
      family.each(d => {
        if (d.x > x1) x1 = d.x;
        if (d.x < x0) x0 = d.x;
      });

      const svg = d3.select("svg")
      // .attr("viewBox", [0, 0, width, x1 - x0 + family.dx * 2])
      .attr('viewBox', [0, 0, 400, 800])
      .append('g')
      .attr("transform", `translate(${family.dy / 3},${family.dx - x0})`)

      const nodes = svg.append('g')
      // const g = d3.select("#tree g")
      // var tree = d3.select('#tree g.nodes')
      var treeNodes = nodes
        .selectAll()
        .data(family.descendants())
        .enter()
        .append('g')

      treeNodes.append('circle')
        // .classed('the-node solid', true)
        .attr('cx', d=> d.x)
        .attr('cy', d=> d.y)
        .attr('r', d => 14)

      const link = svg.append('g')
        .selectAll()
        .data(family.links())
        .enter()
        .append('line')
        .attr("x1", d => d.source.x)
        .attr("y1", d => d.source.y)
        .attr("x2", d => d.target.x)
        .attr("y2", d => d.target.y)
        .style("stroke", "#5f5f5f")
    })
</script>
